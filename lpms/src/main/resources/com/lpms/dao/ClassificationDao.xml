<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lpms.dao.ClassificationDao">
    <select id="listFamilies" resultType="com.lpms.pojo.Family">
        select * from family;
    </select>
    <select id="getFamilyByFamilyId" resultType="com.lpms.pojo.Family">
        select * from family where family_id=#{family_id};
    </select>
    <select id="getFamilyByFamilyName" resultType="com.lpms.pojo.Family">
        select * from family where family_name=#{family_name};
    </select>
    <select id="listGenuses" resultType="com.lpms.pojo.Genus">
        select * from genus;
    </select>
    <select id="getGenusByGenusId" resultType="com.lpms.pojo.Genus">
        select * from genus where genus_id=#{genus_id};
    </select>
    <select id="getGenusByGenusName" resultType="com.lpms.pojo.Genus">
        select * from genus where genus_name=#{genus_name};
    </select>
    <select id="listSpecies" resultType="com.lpms.pojo.Species">
        select * from species;
    </select>
    <select id="getSpeciesBySpeciesId" resultType="com.lpms.pojo.Species">
        select * from species where species_id=#{species_id};
    </select>
    <select id="getSpeciesBySpeciesName" resultType="com.lpms.pojo.Species">
        select * from species where species_name=#{species_name};
    </select>
    <select id="listDistributions" resultType="com.lpms.pojo.Distribution">
        select * from distribution;
    </select>
    <select id="getFamilyByDistributionId" resultType="com.lpms.pojo.Distribution">
        select * from distribution where distribution_id=#{distribution_id};
    </select>
    <select id="getFamilyByDistributionName" resultType="com.lpms.pojo.Distribution">
        select * from distribution where distribution_name=#{distribution_name};
    </select>
    <select id="listEnvironment" resultType="com.lpms.pojo.Environment">
        select * from environment;
    </select>
    <select id="getEnvironmentByEnvironmentId" resultType="com.lpms.pojo.Environment">
        select * from environment where environment_id=#{environment_id};
    </select>
    <select id="getEnvironmentByEnvironmentName" resultType="com.lpms.pojo.Environment">
        select * from environment where environment_name=#{environment_name};
    </select>
    <select id="listGrowth" resultType="com.lpms.pojo.plant.Growth">
        select * from growth;
    </select>
    <select id="getGrowthByGrowthId" resultType="com.lpms.pojo.Genus">
        select * from growth where growth_id=#{growth_id};
    </select>
    <select id="getGrowthByGrowthName" resultType="com.lpms.pojo.Genus">
        select * from growth where growth_name=#{growth_name};
    </select>

    <insert id="insertFamily">
        insert into family (family_id, family_name)
        values (null, #{family_name})
    </insert>
    <insert id="insertGenus">
        insert into genus (genus_id, genus_name, family_id)
        values (null, #{genus_name}, #{family_id})
    </insert>
    <insert id="insertSpecies">
        insert into species (species_id, species_name, genus_id)
        values (null, #{species_name}, #{genus_id})
    </insert>
    <insert id="insertDistribution">
        insert into distribution (distribution_id, distribution_name, family_id)
        values (null, #{distribution_name}, #{family_id})
    </insert>
    <insert id="insertEnvironment">
        insert into environment (environment_id, environment_name)
        values (null, #{environment_name})
    </insert>
    <insert id="insertGrowth">
        insert into growth (growth_id, growth_name)
        values (null, #{growth_name})
    </insert>

    <delete id="deleteFamilyById">
        delete from family where family_id=#{family_id}
    </delete>
    <delete id="deleteFamilyByName">
        delete from family where family_name=#{family_name}
    </delete>
    <delete id="deleteGenusById">
        delete from genus where genus_id=#{genus_id}
    </delete>
    <delete id="deleteGenusByName">
        delete from genus where genus_name=#{genus_name}
    </delete>
    <delete id="deleteSpeciesById">
        delete from species where species_id=#{species_id}
    </delete>
    <delete id="deleteSpeciesByName">
        delete from species where species_name=#{species_name}
    </delete>
    <delete id="deleteDistributionById">
        delete from distribution where distribution_id=#{distribution_id}
    </delete>
    <delete id="deleteDistributionByProvincial">
        delete from distribution where distribution_provincial=#{distribution_provincial}
    </delete>
    <delete id="deleteDistributionByCity">
        delete from distribution where distribution_city=#{distribution_city}
    </delete>
    <delete id="deleteDistributionByCounty">
        delete from distribution where distribution_county=#{distribution_county}
    </delete>
    <delete id="deleteEnvironmentById">
        delete from environment where environment_id=#{environment_id}
    </delete>
    <delete id="deleteEnvironmentByName">
        delete from environment where environment_name=#{environment_name}
    </delete>
    <delete id="deleteGrowthById">
        delete from growth where growth_id=#{growth_id}
    </delete>
    <delete id="deleteGrowthByName">
        delete from growth where growth_name=#{growth_name}
    </delete>

    <update id="updateFamilyNameById">
        update family set family_name=#{family_name} where family_id=#{family_id}
    </update>
    <update id="updateGenusNameById">
        update genus set genus_name=#{genus_name} where genus_id=#{genus_id}
    </update>
    <update id="updateSpeciesById">
        update species
        set species_name = #{species_name},
        species_nickname = #{species_nickname},
        species_feature = #{species_feature},
        species_cultivating = #{species_cultivating},
        species_value = #{species_value},
        genus_id = #{genus_id}
        where species_id = #{species_id}
    </update>
    <update id="updateDistributionById">
        update distribution
        set distribution_name = #{distribution_name},
        distribution_county = #{distribution_county},
        distribution_provincial = #{distribution_provincial},
        distribution_city = #{distribution_city},
        family_id = #{family_id}
        where distribution_id = #{distribution_id}
    </update>
    <update id="updateEnvironmentNameById">
        update environment set environment_name=#{environment_name} where environment_id=#{environment_id}
    </update>
    <update id="updateGrowthById">
        update growth set growth_name=#{growth_name} where growth_id=#{growth_id}
    </update>

    <!-- 查看简易的植物分类信息，也可用于生长环境的模糊查询 -->
    <select id="getSimpleClassificationInfo" resultType="com.lpms.pojo.Simple_Classification_Info">
        SELECT family_name,genus_name,species_name,distribution_provincial,distribution_city, environment
        FROM classification_info_view
        WHERE family_name LIKE CONCAT('%', #{keyword}, '%')
        OR genus_name LIKE CONCAT('%', #{keyword}, '%')
        OR species_name LIKE CONCAT('%', #{keyword}, '%')
        OR distribution_provincial LIKE CONCAT('%', #{keyword}, '%')
        OR distribution_city LIKE CONCAT('%', #{keyword}, '%')
        OR environment LIKE CONCAT('%', #{keyword}, '%')
        ORDER BY family_name,genus_name,species_name,distribution_provincial,distribution_city, environment;
    </select>

    <!-- 查看完整的植物分类信息 -->
    <select id="getCompleteClassificationInfo" resultType="com.lpms.pojo.Complete_Classification_Info">
        SELECT * FROM classification_info_view;
    </select>

    <!-- 根据指定属性查找下属的植物情况 -->
    <select id="findSubordinatePlants" resultType="com.lpms.pojo.Family_Genus_Species_Info">
        SELECT family_name, genus_name, species_name
        FROM Family_Genus_Species_Info
        WHERE (family_name = #{keyword} OR family_id = #{keyword} OR genus_name = #{keyword} OR genus_id = #{keyword}
        OR species_name = #{keyword} OR species_id = #{keyword})
        AND (species_id IS NULL OR species_id = '')
    </select>


</mapper>
